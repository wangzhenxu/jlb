<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Project">
	<resultMap type="com.timeloit.pojo.Project" id="projectMap">
		<result column="project_id" property="projectId" />
		<result column="name" property="name" />
		<result column="code" property="code" />
		<result column="leader" property="leader" />
		<result column="project_desc" property="projectDesc" />
		<result column="create_time" property="createTime" />
	</resultMap>

	<insert id="saveProject" parameterType="com.timeloit.pojo.Project">
		insert into project
		<trim prefix="(" suffix=")" suffixOverrides="," >
			<if test="name != null">
		 		name,
			</if>
			<if test="code != null">
		 		code,
			</if>
			<if test="leader != null">
		 		leader,
			</if>
			<if test="projectDesc != null">
		 		project_desc,
			</if>
			create_time
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides="," >
			<if test="name != null">
		 		#{name},
			</if>
			<if test="code != null">
		 		#{code},
			</if>
			<if test="leader != null">
		 		#{leader},
			</if>
			<if test="projectDesc != null">
		 		#{projectDesc},
			</if>
			now()
		</trim>
		<selectKey resultType="long" keyProperty="projectId" order="AFTER">
			SELECT LAST_INSERT_ID()
		</selectKey>
	</insert>
	
	<!-- 获取项目的总条数 -->
	<select id="getProjectCount" resultType="Integer" parameterType="hashmap">
		select count(1) as counts from project
		<where>
			<if test="name!=null and name!=''">name like '%${name}%'</if>
		</where>
	</select>
	
	<!-- 查询场景列表 -->
	<select id="getProjectList" resultMap="projectMap" parameterType="hashmap">
		select * from project 
		<where>
			<if test="name!=null and name!=''">name like '%${name}%'</if>
		</where>
		order by project_id desc
		<if test="skipResults!=null"> limit #{skipResults},</if>
		<if test="maxResults!=null"> #{maxResults}</if>
	</select>
	
	<!-- 查询单个场景 -->
	<select id="getProject" resultMap="projectMap" parameterType="String">
		select * from project where project_id= #{projectId}
	</select>
	<!-- 更新项目 -->
	<update id="updateProject" parameterType="com.timeloit.pojo.Project" flushCache="true">
		update project	
		<trim prefix="set" suffixOverrides=",">
			<if test="name != null">name= #{name},</if>
			<if test="code != null">code= #{code},</if>
			<if test="leader != null">leader= #{leader},</if>
			<if test="projectDesc != null">project_desc= #{projectDesc}</if>
		</trim>
		<where>
			<if test="projectId!=null">project_id=#{projectId}</if>
		</where>
	</update>
	
	<!-- 删除项目 -->
	<delete id="delProject">
		delete from project 
		where project_id in
			<foreach collection="array" item="projectId"  open="(" separator="," close=")">
            	#{projectId}
        	</foreach>
	</delete>
	
</mapper>